<!DOCTYPE html>
<html lang="id">
<head>
Â  <meta charset="utf-8" />
Â  <meta name="viewport" content="width=device-width,initial-scale=1" />
Â  <title>Kesehatan Mental</title>

Â  <link rel="stylesheet" href="style.css">

Â  <style>
Â  Â  /* ==============================
Â  Â  Â  Â BASE OVERRIDES: tetap jaga struktur awal
Â  Â  Â  Â ============================== */
Â  Â  * { box-sizing: border-box; margin:0; padding:0; font-family: "Poppins", "Segoe UI", Roboto, sans-serif; }
Â  Â  /* Warna font default (Blue/Pink Gradient) akan menggunakan Dark Blue/Pink Gradient */
Â  Â  body { color: #3a5fbf; line-height:1.6; min-height:100vh; position:relative; overflow-x:hidden; transition: color .4s ease, background-color .3s ease; }

Â  Â  body::before{
Â  Â  Â  content: "";
Â  Â  Â  position: fixed;
Â  Â  Â  inset: 0;
Â  Â  Â  z-index: -100;
Â  Â  Â  background: linear-gradient(135deg, #f7f9ff 0%, #f2f7ff 40%, #fff4fb 100%);
Â  Â  Â  transition: background .4s ease;
Â  Â  }

Â  Â  /* Header - sekarang bergradien biru->pink (tetap kotak) */
Â  Â  header {
Â  Â  Â  background: linear-gradient(90deg, #7aa3ff 0%, #ffb3d9 100%);
Â  Â  Â  padding: 1rem 0;
Â  Â  Â  text-align: center;
Â  Â  Â  position: relative;
Â  Â  Â  overflow: visible;
Â  Â  Â  transition: background .4s ease;
Â  Â  }
Â  Â  header h1 { margin-bottom: 8px; font-size: 1.8rem; color: #3a5fbf; } /* Dark Blue for Default */

Â  Â  nav ul { list-style:none; display:flex; justify-content:center; gap:18px; flex-wrap:wrap; margin-top:6px; }
Â  Â  nav ul li a { text-decoration:none; font-weight:600; padding:6px 8px; display:inline-block; color: #3a5fbf; } /* Dark Blue for Default */
Â  Â  nav ul li a:hover { text-decoration:underline; }

Â  Â  section { padding: 40px 20px; max-width: 900px; margin: 20px auto; background: transparent; }

Â  Â  /* H2 - Default to Dark Blue/Pink Gradient */
Â  Â  h2 {
Â  Â  Â  margin-bottom:10px;
Â  Â  Â  transition: all .4s ease; /* Tambahkan transisi untuk tema */
Â  Â  Â  /* Dark Blue/Pink Gradient for Default H2/Accent */
Â  Â  Â  background: linear-gradient(90deg, #3a5fbf 0%, #c4407b 100%);
Â  Â  Â  -webkit-background-clip: text;
Â  Â  Â  -webkit-text-fill-color: transparent;
Â  Â  Â  background-clip: text;
Â  Â  Â  text-fill-color: transparent;
Â  Â  }

Â  Â  form { margin-top:20px; background: white; padding:18px; border-radius:12px; box-shadow: 0 6px 18px rgba(30,40,80,0.06); }

Â  Â  .question { margin-bottom:12px; }
Â  Â  /* INPUT NUMBER STYLE */
Â  Â  input[type="number"] {
Â  Â  Â  padding:8px;
Â  Â  Â  border-radius:6px;
Â  Â  Â  border:1px solid #ddd;
Â  Â  Â  width: 60px; /* Ukuran kecil */
Â  Â  Â  text-align: center;
Â  Â  Â  -moz-appearance: textfield; /* Hide arrows in Firefox */
Â  Â  }
Â  Â  input[type="number"]::-webkit-outer-spin-button,
Â  Â  input[type="number"]::-webkit-inner-spin-button {
Â  Â  Â  -webkit-appearance: none; /* Hide arrows in Chrome/Safari */
Â  Â  Â  margin: 0;
Â  Â  }
Â  Â Â 
Â  Â  button, .btn {
Â  Â  Â  background: #9ebdff;
Â  Â  Â  color:white;
Â  Â  Â  padding:10px 16px;
Â  Â  Â  border:none;
Â  Â  Â  border-radius:8px;
Â  Â  Â  cursor:pointer;
Â  Â  Â  font-weight:600;
Â  Â  Â  position:relative;
Â  Â  Â  overflow:visible;
Â  Â  Â  transition: transform .12s ease, box-shadow .12s ease, background .4s ease, color .4s ease;
Â  Â  }
Â  Â  button:hover, .btn:hover { transform: translateY(-3px); box-shadow: 0 6px 18px rgba(32,48,120,0.12); }

Â  Â  #hasil { margin-top:18px; background:#eaf2ff; padding:14px; border-radius:10px; }

Â  Â  footer { text-align:center; background:transparent; color:inherit; padding:18px 10px; margin-top:40px; }

Â  Â  .card {
Â  Â  Â  background: rgba(255,255,255,0.9);
Â  Â  Â  border-radius: 12px;
Â  Â  Â  padding: 12px;
Â  Â  Â  box-shadow: 0 6px 18px rgba(30,40,80,0.05);
Â  Â  Â  height: 100%;
Â  Â  }

Â  Â  .question-label {
Â  Â  Â  Â  color: inherit; /* Pastikan label mengikuti warna body */
Â  Â  }

Â  Â  /* Tata letak grid untuk pertanyaan */
Â  Â  .questions-grid {
Â  Â  Â  display:grid;
Â  Â  Â  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
Â  Â  Â  gap:15px; /* Tambah gap */
Â  Â  }
Â  Â  /* Style untuk form pertanyaan */
Â  Â  .question-item {
Â  Â  Â  Â  display:flex;
Â  Â  Â  Â  flex-direction:column;
Â  Â  Â  Â  gap:6px;
Â  Â  }
Â  Â  .question-label {
Â  Â  Â  Â  display:block;
Â  Â  Â  Â  font-weight:600;
Â  Â  Â  Â  margin-bottom:4px;
Â  Â  Â  Â  color: inherit;
Â  Â  }
Â  Â  .score-control {
Â  Â  Â  Â  display:flex;
Â  Â  Â  Â  gap:8px;
Â  Â  Â  Â  align-items:center;
Â  Â  }

Â  Â  /* RUANG CERITA / STORY BOX STYLES (NEW) */
Â  Â  #quotes-section { padding: 0; border-radius:12px; background: none; box-shadow: none; }
Â  Â Â 
Â  Â  .story-card {
Â  Â  Â  background: rgba(255,255,255,0.9);
Â  Â  Â  border-radius: 12px;
Â  Â  Â  padding: 20px;
Â  Â  Â  box-shadow: 0 6px 18px rgba(30,40,80,0.05);
Â  Â  Â  margin-bottom: 25px;
Â  Â  }
Â  Â Â 
Â  Â  #story-textarea, #topic-select {
Â  Â  Â  width: 100%;Â 
Â  Â  Â  padding: 10px;Â 
Â  Â  Â  border-radius: 8px;Â 
Â  Â  Â  border: 1px solid #ddd;Â 
Â  Â  Â  margin-top: 5px;
Â  Â  Â  font-family: inherit;
Â  Â  Â  font-size: 1rem;
Â  Â  Â  background: white;
Â  Â  }
Â  Â  #story-textarea {
Â  Â  Â  Â  resize: vertical;Â 
Â  Â  Â  Â  min-height: 150px;
Â  Â  Â  Â  margin-bottom: 10px;
Â  Â  }
Â  Â Â 
Â  Â  /* Response Message Box */
Â  Â  #response-message {
Â  Â  Â  Â  margin-top: 20px;
Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  border-left: 5px solid #7aa3ff; /* Accent blue (Default) */
Â  Â  Â  Â  background: #f0f7ff;
Â  Â  Â  Â  color: inherit;
Â  Â  Â  Â  display: none; /* Hidden by default */
Â  Â  Â  Â  font-weight: 500;
Â  Â  Â  Â  transition: all 0.3s ease;
Â  Â  }

Â  Â  /* Styles for list of stories */
Â  Â  .story-list-item {
Â  Â  Â  Â  margin-bottom: 15px;
Â  Â  Â  Â  border: 1px solid #eee;
Â  Â  Â  Â  padding: 15px;
Â  Â  Â  Â  border-radius: 8px;
Â  Â  Â  Â  background: white;
Â  Â  Â  Â  transition: all 0.2s ease;
Â  Â  }
Â  Â  .story-list-item:hover {
Â  Â  Â  Â  box-shadow: 0 4px 12px rgba(30,40,80,0.08);
Â  Â  }
Â  Â  .story-list-item h4 {
Â  Â  Â  Â  margin-bottom: 5px;
Â  Â  Â  Â  color: inherit;
Â  Â  }
Â  Â  .delete-story-btn { background:#ff9999 !important; color:#333 !important; }

Â  Â Â 
Â  Â  /* Theme chooser: DROPDOWN style */
Â  Â  .theme-chooser {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  gap: 5px;
Â  Â  Â  Â  padding: 6px 0; /* Padding agar sejajar dengan link navigasi */
Â  Â  }
Â  Â  .theme-chooser select, #quote-select {
Â  Â  Â  padding:4px 8px; /* Dikecilkan agar pas di nav */
Â  Â  Â  border-radius:8px; border:1px solid #ddd; background-color:white; cursor:pointer;
Â  Â  Â  box-shadow: 0 3px 6px rgba(0,0,0,0.05);
Â  Â  Â  min-width: 130px;
Â  Â  Â  appearance: auto;
Â  Â  Â  font-size: 0.9rem;
Â  Â  }
Â  Â Â 
Â  Â  /* Style untuk label tema di header (agar mengikuti warna link) */
Â  Â  header nav .theme-chooser label {
Â  Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  Â  font-weight: 600;
Â  Â  Â  Â  color: #3a5fbf; /* Default Dark Blue */
Â  Â  Â  Â  white-space: nowrap;
Â  Â  }


Â  Â  /* ==============================
Â  Â  Â  Â Theme Specific Styles (Dark Font Colors & New Elements)
Â  Â  Â  Â ============================== */
Â  Â  /* Pastel Pink Theme */
Â  Â  body[data-theme="pink"] { color: #7d445c; } /* Dark Pink for all text */
Â  Â  header[data-theme="pink"] h1, header[data-theme="pink"] nav ul li a, header[data-theme="pink"] nav .theme-chooser label { color: #7d445c; }
Â  Â  h2[data-theme="pink"] {
Â  Â  Â  Â  color: #c4407b; /* Darker Pink for headings/accents */
Â  Â  Â  Â  background: none;
Â  Â  Â  Â  -webkit-text-fill-color: initial;
Â  Â  Â  Â  background-clip: initial;
Â  Â  }
Â  Â  #response-message[data-theme="pink"] { border-left-color: #ffb3d9; background: #fff4fb; }
Â  Â  .story-list-item[data-theme="pink"] { border: 1px solid #ffb3d9; }

Â  Â  /* Pastel Blue Theme */
Â  Â  body[data-theme="blue"] { color: #30538a; } /* Dark Blue for all text */
Â  Â  header[data-theme="blue"] h1, header[data-theme="blue"] nav ul li a, header[data-theme="blue"] nav .theme-chooser label { color: #30538a; }
Â  Â  h2[data-theme="blue"] {
Â  Â  Â  Â  color: #1a407a; /* Darker Blue for headings/accents */
Â  Â  Â  Â  background: none;
Â  Â  Â  Â  -webkit-text-fill-color: initial;
Â  Â  Â  Â  background-clip: initial;
Â  Â  }
Â  Â  #response-message[data-theme="blue"] { border-left-color: #7aa3ff; background: #f0f7ff; }
Â  Â  .story-list-item[data-theme="blue"] { border: 1px solid #7aa3ff; }

Â  Â  /* Pastel Purple Theme */
Â  Â  body[data-theme="purple"] { color: #53308a; } /* Dark Purple for all text */
Â  Â  header[data-theme="purple"] h1, header[data-theme="purple"] nav ul li a, header[data-theme="purple"] nav .theme-chooser label { color: #53308a; }
Â  Â  h2[data-theme="purple"] {
Â  Â  Â  Â  color: #6035b3; /* Darker Purple for headings/accents */
Â  Â  Â  Â  background: none;
Â  Â  Â  Â  -webkit-text-fill-color: initial;
Â  Â  Â  Â  background-clip: initial;
Â  Â  }
Â  Â  #response-message[data-theme="purple"] { border-left-color: #b380ff; background: #f8f0ff; }
Â  Â  .story-list-item[data-theme="purple"] { border: 1px solid #b380ff; }

Â  Â  /* Gradient Rainbow Theme */
Â  Â  body[data-theme="rainbow"] { color: #333; } /* Base color dark */
Â  Â  header[data-theme="rainbow"] h1, header[data-theme="rainbow"] nav ul li a, header[data-theme="rainbow"] nav .theme-chooser label { color: #333; }
Â  Â  h2[data-theme="rainbow"] {
Â  Â  Â  Â  /* Dark Rainbow Gradient for headings/accents */
Â  Â  Â  Â  background: linear-gradient(90deg, #b3579b, #3a5fbf, #53308a);
Â  Â  Â  Â  -webkit-background-clip: text;
Â  Â  Â  Â  -webkit-text-fill-color: transparent;
Â  Â  Â  Â  background-clip: text;
Â  Â  Â  Â  text-fill-color: transparent;
Â  Â  Â  Â  color: initial;
Â  Â  }
Â  Â  #response-message[data-theme="rainbow"] {Â 
Â  Â  Â  Â  border-left: 5px solid;Â 
Â  Â  Â  Â  border-image: linear-gradient(180deg, #b3579b, #3a5fbf) 1;
Â  Â  Â  Â  background: #f7f7f7;
Â  Â  }
Â  Â  .story-list-item[data-theme="rainbow"] {Â 
Â  Â  Â  Â  border: 1px solid;Â 
Â  Â  Â  Â  border-image: linear-gradient(90deg, #b3579b, #3a5fbf) 1;
Â  Â  }

Â  Â  /* Override button styling for themes */
Â  Â  button[data-theme="pink"], .btn[data-theme="pink"] { background: #ffb3d9; color: #333; }
Â  Â  button[data-theme="blue"], .btn[data-theme="blue"] { background: #7aa3ff; color: white; }
Â  Â  button[data-theme="purple"], .btn[data-theme="purple"] { background: #b380ff; color: white; }
Â  Â  button[data-theme="rainbow"], .btn[data-theme="rainbow"] { background: linear-gradient(90deg,#ffd6f0,#dbe9ff); color: #333; }

Â  Â  /* ==============================
Â  Â  Â  Â Small responsiveness
Â  Â  Â  Â ============================== */
Â  Â  @media (max-width:720px){
Â  Â  Â  header h1 { font-size:1.4rem; }
Â  Â  Â  nav ul { gap:10px; font-size:0.95rem; }
Â  Â  Â  .cloud.c1, .cloud.c2, .cloud.c3 { display:block; opacity:.6; }
Â  Â  Â  .questions-grid { grid-template-columns: 1fr; } /* Satu kolom di layar kecil */
Â  Â  }
Â  Â  @media (max-width: 550px) {
Â  Â  Â  Â  nav ul { flex-direction: column; gap: 5px; } /* Susun vertikal jika layar terlalu sempit */
Â  Â  Â  Â  .theme-chooser { justify-content: center; }
Â  Â  }

Â  </style>
</head>
<body>

Â  <div class="clouds" aria-hidden="true">
Â  Â  <div class="cloud c1" style="left:-30%; top:8%;"></div>
Â  Â  <div class="cloud c2" style="left:-40%; top:38%;"></div>
Â  Â  <div class="cloud c3" style="left:-50%; top:68%;"></div>
Â  </div>

Â  <header id="main-header">
Â  Â  <div class="sparkle s1" aria-hidden="true"></div>
Â  Â  <div class="sparkle s2" aria-hidden="true"></div>
Â  Â  <div class="sparkle s3" aria-hidden="true"></div>

Â  Â  <h1>Kesehatan Mental</h1>

Â  Â  <nav>
Â  Â  Â  <ul>
Â  Â  Â  Â  <li><a href="#pencegahan">Pencegahan</a></li>
Â  Â  Â  Â  <li><a href="#tanda">Tanda-tanda</a></li>
Â  Â  Â  Â  <li><a href="#mengatasi">Mengatasi</a></li>
Â  Â  Â  Â  <li><a href="#angket">Tes Mental</a></li>
Â  Â  Â  Â  <li><a href="#quotes">Ruang Cerita</a></li> <li class="theme-menu-item">
Â  Â  Â  Â  Â  Â  <div class="theme-chooser">
Â  Â  Â  Â  Â  Â  Â  Â  <label for="theme-select">Tema:</label>
Â  Â  Â  Â  Â  Â  Â  Â  <select id="theme-select" aria-label="Pilih tema warna">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="default">Default (Blue/Pink)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="pink">Pastel Pink</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="blue">Pastel Blue</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="purple">Pastel Purple</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="rainbow">Gradient Rainbow</option>
Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </li>
Â  Â  Â  </ul>
Â  Â  </nav>
Â  </header>

Â  <section id="pencegahan">
Â  Â  <h2 id="h2-pencegahan">Cara Pencegahan Gangguan Mental</h2>
Â  Â  <ul>
Â  Â  Â  <li>Menjaga keseimbangan antara pekerjaan dan istirahat.</li>
Â  Â  Â  <li>Berolahraga secara teratur.</li>
Â  Â  Â  <li>Menjaga pola makan sehat dan tidur cukup.</li>
Â  Â  Â  <li>Berbicara dengan orang yang dipercaya saat menghadapi stres.</li>
Â  Â  Â  <li>Hindari konsumsi alkohol dan narkoba.</li>
Â  Â  </ul>
Â  </section>

Â  <section id="tanda">
Â  Â  <h2 id="h2-tanda">Tanda-tanda Gangguan Mental</h2>
Â  Â  <ul>
Â  Â  Â  <li>Merasa sedih atau cemas berkepanjangan.</li>
Â  Â  Â  <li>Kehilangan minat terhadap aktivitas yang disukai.</li>
Â  Â  Â  <li>Perubahan nafsu makan atau pola tidur.</li>
Â  Â  Â  <li>Sulit berkonsentrasi.</li>
Â  Â  Â  <li>Menarik diri dari lingkungan sosial.</li>
Â  Â  </ul>
Â  </section>

Â  <section id="mengatasi">
Â  Â  <h2 id="h2-mengatasi">Cara Mengatasi Gangguan Mental</h2>
Â  Â  <ul>
Â  Â  Â  <li>Konsultasi dengan psikolog atau psikiater.</li>
Â  Â  Â  <li>Terapi perilaku kognitif atau konseling.</li>
Â  Â  Â  <li>Menulis jurnal atau meditasi.</li>
Â  Â  Â  <li>Meningkatkan dukungan sosial.</li>
Â  Â  Â  <li>Berpartisipasi dalam kegiatan positif.</li>
Â  Â  </ul>
Â  </section>

Â  <section id="angket">
Â  Â  <h2 id="h2-angket">Tes Kesehatan Mental</h2>

Â  Â  <button id="toggle-test-btn" class="btn" style="margin-bottom:20px;">
Â  Â  Â  Â  Mulai Tes Kesehatan <span class="toggle-icon">â–¼</span>
Â  Â  </button>

Â  Â  <div id="test-content-container" class="card" style="display:none;">
Â  Â  Â Â 
Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  <div class="tests-tabs" role="tablist" aria-label="Pilih tes" style="margin-bottom: 14px;">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab active" data-test="stres">Tes Stres (15)</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab" data-test="kecemasan">Tes Kecemasan</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab" data-test="kebahagiaan">Tes Kebahagiaan</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab" data-test="keseimbangan">Tes Keseimbangan Hidup</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div id="panels" style="margin-top:14px;">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="test-panel active" data-testpanel="stres">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form class="test-form" data-questions="15">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;flex-direction:column;gap:15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="questions-grid">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;gap:10px; margin-top:8px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn" id="submitStres">Lihat Hasil <span class="hover-ico">âœ¨</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="btn btn-reset" style="background:#fff;color:#333;border:1px solid #eee;">Reset <span class="hover-ico">â™¡</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="test-panel" data-testpanel="kecemasan">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form class="test-form" data-questions="10">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;flex-direction:column;gap:15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="questions-grid"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;gap:10px; margin-top:8px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn">Lihat Hasil <span class="hover-ico">âœ¨</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="btn btn-reset" style="background:#fff;color:#333;border:1px solid #eee;">Reset <span class="hover-ico">â™¡</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="test-panel" data-testpanel="kebahagiaan">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form class="test-form" data-questions="8">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;flex-direction:column;gap:15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="questions-grid"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;gap:10px; margin-top:8px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn">Lihat Hasil <span class="hover-ico">âœ¨</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="btn btn-reset" style="background:#fff;color:#333;border:1px solid #eee;">Reset <span class="hover-ico">â™¡</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="test-panel" data-testpanel="keseimbangan">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <form class="test-form" data-questions="12">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;flex-direction:column;gap:15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="questions-grid"></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div style="display:flex;gap:10px; margin-top:8px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="submit" class="btn">Lihat Hasil <span class="hover-ico">âœ¨</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button type="button" class="btn btn-reset" style="background:#fff;color:#333;border:1px solid #eee;">Reset <span class="hover-ico">â™¡</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </form>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div id="hasil-area" style="margin-top:16px; display:none;" class="card">
Â  Â  Â  Â  Â  Â  Â  Â  <h3 id="hasil-title">Hasil Tes</h3>
Â  Â  Â  Â  Â  Â  Â  Â  <p id="hasil-emoji" style="font-size:2rem; margin:8px 0;">ğŸ™‚</p>
Â  Â  Â  Â  Â  Â  Â  Â  <p id="hasil-score" style="font-weight:700;"></p>
Â  Â  Â  Â  Â  Â  Â  Â  <p id="hasil-interpretasi"></p>
Â  Â  Â  Â  Â  Â  Â  Â  <div style="margin-top:8px; display:flex; gap:8px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn" id="saveLocal">Simpan Hasil <span class="hover-ico">â™¡</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn" id="downloadResult" style="background:#fff;color:#333;border:1px solid #eee;">Download <span class="hover-ico">âœ¨</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>
Â  </section>

Â  <section id="quotes" style="max-width:980px;margin:30px auto;">
Â  Â  <h2 id="h2-quotes">Ruang Cerita</h2>
Â  Â  <div id="quotes-section">
Â  Â  Â Â 
Â  Â  Â  <div class="story-card" id="story-input-card">
Â  Â  Â  Â  Â  <h3 style="margin-bottom: 15px; color:inherit;">Tulis Cerita atau Curhatmu</h3>
Â  Â  Â  Â  Â  <form id="story-form">
Â  Â  Â  Â  Â  Â  Â  <div style="margin-bottom: 15px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="topic-select" style="font-weight: 600; display: block; margin-bottom: 5px;">Pilih Topik:</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="topic-select" aria-label="Pilih Topik Curhat" required>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="">-- Pilih Topik --</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="pribadi">Masalah Pribadi/Diri Sendiri</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="pekerjaan">Pekerjaan/Pendidikan</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="keluarga">Keluarga/Rumah</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="hubungan">Hubungan Sosial/Pasangan</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="umum">Lain-lain (Umum)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  <label for="story-textarea" style="font-weight: 600; display: block;">Cerita Anda:</label>
Â  Â  Â  Â  Â  Â  Â  <textarea id="story-textarea" rows="8" placeholder="Bagikan apa yang kamu rasakan di sini..." aria-label="Tulis cerita atau curhat pribadi" required></textarea>
Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  <button id="submit-story-btn" class="btn" type="submit">Kirim Cerita <span class="hover-ico">ğŸ’Œ</span></button>
Â  Â  Â  Â  Â  </form>

Â  Â  Â  Â  Â  <div id="response-message" class="card">
Â  Â  Â  Â  Â  Â  Â  <h4 style="margin-bottom: 5px; color:inherit;">Respon Untukmu:</h4>
Â  Â  Â  Â  Â  Â  Â  <p id="response-text"></p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  Â Â 
Â  Â  Â  <div id="saved-stories-container">
Â  Â  Â  Â  Â  <h3 style="margin-bottom: 15px; color:inherit;">Daftar Cerita Tersimpan</h3>
Â  Â  Â  Â  Â  <div id="stories-list">
Â  Â  Â  Â  Â  Â  Â  <p class="card" style="padding: 15px; color: #999;">Belum ada cerita yang tersimpan.</p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  </div>
Â  </section>

Â  <footer>
Â  Â  <p>Â© 2025 Kesehatan Mental | Dibuat dengan â¤ï¸</p>
Â  </footer>

Â  <script>
Â  Â  /**********************
Â  Â  Â * UTIL: questions templates (placeholder texts)
Â  Â  Â **********************/
Â  Â  const sampleQs = {
Â  Â  Â  stres: [
Â  Â  Â  Â  "Saya merasa mudah marah atau tersinggung.",
Â  Â  Â  Â  "Saya sulit rileks.",
Â  Â  Â  Â  "Saya merasa tertekan dengan tuntutan sehari-hari.",
Â  Â  Â  Â  "Pikiran saya sering berputar tanpa henti.",
Â  Â  Â  Â  "Saya merasa lelah karena beban pikiran.",
Â  Â  Â  Â  "Saya mudah terganggu oleh hal kecil.",
Â  Â  Â  Â  "Saya merasa tidak sabar.",
Â  Â  Â  Â  "Saya khawatir tidak bisa menyelesaikan tugas.",
Â  Â  Â  Â  "Saya sering merasa cemas tanpa alasan jelas.",
Â  Â  Â  Â  "Tidur saya terganggu karena pikiran.",
Â  Â  Â  Â  "Saya merasa tegang otot atau sakit kepala karena stres.",
Â  Â  Â  Â  "Saya sulit berkonsentrasi.",
Â  Â  Â  Â  "Saya khawatir berlebihan tentang masa depan.",
Â  Â  Â  Â  "Saya merasa kewalahan ketika banyak tugas.",
Â  Â  Â  Â  "Saya sulit menenangkan diri setelah kejadian menegangkan."
Â  Â  Â  ],
Â  Â  Â  kecemasan: [
Â  Â  Â  Â  "Saya sering merasa cemas tanpa alasan yang jelas.",
Â  Â  Â  Â  "Saya khawatir berlebihan terhadap hal kecil.",
Â  Â  Â  Â  "Saya merasa gelisah di keramaian.",
Â  Â  Â  Â  "Saya sulit tidur karena pikiran cemas.",
Â  Â  Â  Â  "Saya khawatir tentang kesehatan saya terus-menerus.",
Â  Â  Â  Â  "Saya merasa napas cepat saat cemas.",
Â  Â  Â  Â  "Saya menghindari situasi karena takut cemas.",
Â  Â  Â  Â  "Saya merasa ada yang tidak terkendali.",
Â  Â  Â  Â  "Saya sering memikirkan kemungkinan terburuk.",
Â  Â  Â  Â  "Saya sulit menenangkan diri saat khawatir."
Â  Â  Â  ],
Â  Â  Â  kebahagiaan: [
Â  Â  Â  Â  "Saya merasa puas dengan hidup saya saat ini.",
Â  Â  Â  Â  "Saya mudah merasakan kebahagiaan dalam hal sederhana.",
Â  Â  Â  Â  "Saya merasa memiliki tujuan yang memotivasi.",
Â  Â  Â  Â  "Saya merasa dekat dan terhubung dengan orang lain.",
Â  Â  Â  Â  "Saya menikmati waktu sendirian tanpa merasa sedih.",
Â  Â  Â  Â  "Saya sering tersenyum tanpa alasan khusus.",
Â  Â  Â  Â  "Saya bersyukur atas hal-hal kecil setiap hari.",
Â  Â  Â  Â  "Saya merasa optimis tentang masa depan."
Â  Â  Â  ],
Â  Â  Â  keseimbangan: [
Â  Â  Â  Â  "Saya merasa pekerjaan dan kehidupan pribadi seimbang.",
Â  Â  Â  Â  "Saya cukup tidur dan istirahat.",
Â  Â  Â  Â  "Saya punya waktu untuk hobi dan rekreasi.",
Â  Â  Â  Â  "Saya menjaga pola makan yang baik.",
Â  Â  Â  Â  "Saya meluangkan waktu untuk olahraga.",
Â  Â  Â  Â  "Saya merasa hubungan sosial saya sehat.",
Â  Â  Â  Â  "Saya memiliki waktu untuk refleksi diri.",
Â  Â  Â  Â  "Saya bisa mengelola stres secara rutin.",
Â  Â  Â  Â  "Saya merasa punya dukungan saat sulit.",
Â  Â  Â  Â  "Saya memberi waktu untuk pengembangan diri.",
Â  Â  Â  Â  "Saya merasa bebas dari beban finansial yang berlebihan.",
Â  Â  Â  Â  "Saya menikmati kegiatan yang menenangkan."
Â  Â  Â  ]
Â  Â  };

Â  Â  /**********************
Â  Â  Â * Render questions into each panel (Using INPUT TYPE="NUMBER")
Â  Â  Â **********************/
Â  Â  document.querySelectorAll('.test-panel').forEach(panel=>{
Â  Â  Â  const form = panel.querySelector('.test-form');
Â  Â  Â  const grid = form.querySelector('.questions-grid');
Â  Â  Â  const qKey = panel.dataset.testpanel;
Â  Â  Â  const qArr = sampleQs[qKey] || [];
Â  Â  Â  const questionsCount = parseInt(form.dataset.questions,10) || qArr.length;

Â  Â  Â  let finalQs = [];
Â  Â  Â  for (let i=0;i<questionsCount;i++){
Â  Â  Â  Â  finalQs.push(qArr[i % qArr.length] || `Pertanyaan ${i+1}`);
Â  Â  Â  }

Â  Â  Â  grid.innerHTML = '';
Â  Â  Â  finalQs.forEach((q,i)=>{
Â  Â  Â  Â  const idx = i+1;
Â  Â  Â  Â  const item = document.createElement('div');
Â  Â  Â  Â  item.className = 'card question-item';
Â  Â  Â  Â  item.innerHTML = `
Â  Â  Â  Â  Â  <label class="question-label" for="${qKey}-q${idx}">${idx}. ${q}</label>
Â  Â  Â  Â  Â  <div class="score-control">
Â  Â  Â  Â  Â  Â  <input type="number" id="${qKey}-q${idx}" name="${qKey}-q${idx}" required min="1" max="5" value="1" data-qindex="${i}">
Â  Â  Â  Â  Â  Â  <small style="color:inherit;">(Skor 1-5)</small>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â  grid.appendChild(item);
Â  Â  Â  });
Â  Â  });

Â  Â  /**********************
Â  Â  Â * Toggle Test Content Visibility
Â  Â  Â **********************/
Â  Â  const toggleBtn = document.getElementById('toggle-test-btn');
Â  Â  const testContainer = document.getElementById('test-content-container');
Â  Â  const toggleIcon = toggleBtn.querySelector('.toggle-icon');

Â  Â  toggleBtn.addEventListener('click', () => {
Â  Â  Â  Â  const isHidden = testContainer.style.display === 'none';
Â  Â  Â  Â Â 
Â  Â  Â  Â  if (isHidden) {
Â  Â  Â  Â  Â  Â  testContainer.style.display = 'block';
Â  Â  Â  Â  Â  Â  toggleBtn.innerHTML = 'Sembunyikan Tes Kesehatan <span class="toggle-icon">â–²</span>';
Â  Â  Â  Â  Â  Â  // Scroll to the top of the test content area for better UX
Â  Â  Â  Â  Â  Â  testContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  testContainer.style.display = 'none';
Â  Â  Â  Â  Â  Â  toggleBtn.innerHTML = 'Mulai Tes Kesehatan <span class="toggle-icon">â–¼</span>';
Â  Â  Â  Â  }
Â  Â  });

Â  Â  /**********************
Â  Â  Â * Tabs behavior
Â  Â  Â **********************/
Â  Â  document.querySelectorAll('.tab').forEach(t => {
Â  Â  Â  t.addEventListener('click', () => {
Â  Â  Â  Â  document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
Â  Â  Â  Â  t.classList.add('active');
Â  Â  Â  Â  const key = t.dataset.test;
Â  Â  Â  Â  document.querySelectorAll('.test-panel').forEach(p=>{
Â  Â  Â  Â  Â  p.classList.toggle('active', p.dataset.testpanel === key);
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById('hasil-area').style.display = 'none';
Â  Â  Â  Â  // Reset inputs on switch (optional, but good UX)
Â  Â  Â  Â  document.querySelectorAll('.test-form input[type="number"]').forEach(s => s.value = 1);
Â  Â  Â  });
Â  Â  });

Â  Â  /**********************
Â  Â  Â * Scoring & Interpretation (common function)
Â  Â  Â **********************/
Â  Â  function interpretResult(total, questions, testKey){
Â  Â  Â  const max = questions*5;
Â  Â  Â  // we'll compute 'scorePercent' similar: healthier => higher percent (lower total for Stres/Cemas is better)
Â  Â  Â  const healthyPercent = Math.round(((max - total) / max) * 100);
Â  Â  Â  let emoji='ğŸ™‚', title='OK', interp='';

Â  Â  Â  if (testKey === 'kebahagiaan') {
Â  Â  Â  Â  // For 'kebahagiaan', a higher raw score (total) means better (healthier). We need to invert the formula logic for this test.
Â  Â  Â  Â  const happinessScore = total; // 8*1 (8) to 8*5 (40)
Â  Â  Â  Â  const min = questions*1;
Â  Â  Â  Â  const happyPercent = Math.round(((happinessScore - min) / (max - min)) * 100);

Â  Â  Â  Â  if (happyPercent >= 80) { emoji='ğŸ¤©'; title='Sangat Bahagia'; interp='Kamu merasa sangat bahagia. Pertahankan rasa syukur dan kebiasaan positif.'; }
Â  Â  Â  Â  else if (happyPercent >= 50) { emoji='ğŸ˜Š'; title='Cukup Bahagia'; interp='Kamu cukup bahagia. Coba rutinitas kecil yang membahagiakan untuk meningkatkannya.'; }
Â  Â  Â  Â  else { emoji='ğŸ˜•'; title='Kurang Bahagia'; interp='Pertimbangkan aktivitas yang memberi makna dan meningkatkan hubungan sosial.'; }
Â  Â  Â  Â  return { emoji, title, interp, healthyPercent: happyPercent }; // Return happyPercent as the score
Â  Â  Â  }

Â  Â  Â  // For Stres, Kecemasan, Keseimbangan: lower total = higher healthyPercent
Â  Â  Â  if (testKey === 'stres') {
Â  Â  Â  Â  if (healthyPercent >= 80) { emoji='ğŸ˜Œ'; title='Stres Rendah'; interp='Kamu tampak punya mekanisme koping yang baik. Pertahankan kebiasaan positif.'; }
Â  Â  Â  Â  else if (healthyPercent >= 50) { emoji='ğŸ™‚'; title='Stres Sedang'; interp='Perhatikan tanda-tanda stres â€” coba teknik relaksasi seperti bernapas atau jalan singkat.'; }
Â  Â  Â  Â  else { emoji='ğŸ˜Ÿ'; title='Stres Tinggi'; interp='Kamu mengalami tingkat stres yang cukup tinggi. Pertimbangkan berbicara dengan orang terpercaya atau profesional.'; }
Â  Â  Â  } else if (testKey === 'kecemasan') {
Â  Â  Â  Â  if (healthyPercent >= 80) { emoji='ğŸ˜Š'; title='Kecemasan Rendah'; interp='Kecemasanmu rendah. Lanjutkan aktivitas yang menenangkan.'; }
Â  Â  Â  Â  else if (healthyPercent >= 50) { emoji='ğŸ˜'; title='Kecemasan Sedang'; interp='Coba teknik pernapasan, kurangi kafein, dan istirahat cukup.'; }
Â  Â  Â  Â  else { emoji='ğŸ˜°'; title='Kecemasan Tinggi'; interp='Pertimbangkan dukungan lebih lanjut â€” konsultasi profesional dapat membantu.'; }
Â  Â  Â  } else if (testKey === 'keseimbangan') {
Â  Â  Â  Â  if (healthyPercent >= 80) { emoji='ğŸŒ¿'; title='Seimbang'; interp='Kehidupanmu tampak seimbang. Jaga konsistensi dan istirahat.'; }
Â  Â  Â  Â  else if (healthyPercent >= 50) { emoji='âš–ï¸'; title='Cukup Seimbang'; interp='Perhatikan area yang kurang â€” coba atur jadwal dan kurangi beban.'; }
Â  Â  Â  Â  else { emoji='ğŸ”„'; title='Kurang Seimbang'; interp='Pertimbangkan langkah sederhana: tidur, olahraga ringan, dan dukungan sosial.'; }
Â  Â  Â  } else {
Â  Â  Â  Â  // Fallback for any other test
Â  Â  Â  Â  if (healthyPercent >= 80) { emoji='ğŸ™‚'; title='Baik'; interp='Hasil menunjukkan kondisi yang cukup baik.'; }
Â  Â  Â  Â  else if (healthyPercent >= 50) { emoji='ğŸ˜'; title='Perlu Perhatian'; interp='Perlu beberapa perbaikan.'; }
Â  Â  Â  Â  else { emoji='ğŸ˜Ÿ'; title='Perhatian Lebih'; interp='Disarankan untuk mencari dukungan.'; }
Â  Â  Â  }

Â  Â  Â  return { emoji, title, interp, healthyPercent };
Â  Â  }


Â  Â  /**********************
Â  Â  Â * Handle form submissions for all tests
Â  Â  Â **********************/
Â  Â  document.querySelectorAll('.test-form').forEach(form=>{
Â  Â  Â  form.addEventListener('submit', function(e){
Â  Â  Â  Â  e.preventDefault();
Â  Â  Â  Â  // Use number inputs
Â  Â  Â  Â  const inputs = Array.from(form.querySelectorAll('input[type="number"]'));

Â  Â  Â  Â  // Check for required fields and value range
Â  Â  Â  Â  let total = 0;
Â  Â  Â  Â  let isValid = true;
Â  Â  Â  Â  inputs.forEach(inp => {
Â  Â  Â  Â  Â  Â  let v = parseInt(inp.value,10);
Â  Â  Â  Â  Â  Â  if (isNaN(v) || v < 1 || v > 5) {
Â  Â  Â  Â  Â  Â  Â  Â  isValid = false;
Â  Â  Â  Â  Â  Â  Â  Â  inp.style.border = '2px solid red'; // Highlight invalid input
Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  inp.style.border = '1px solid #ddd'; // Reset border
Â  Â  Â  Â  Â  Â  Â  Â  total += v;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });

Â  Â  Â  Â  if (!isValid) {
Â  Â  Â  Â  Â  Â  alert("Harap isi semua pertanyaan dengan skor antara 1 sampai 5.");
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  const activePanel = form.closest('.test-panel');
Â  Â  Â  Â  const testKey = activePanel ? activePanel.dataset.testpanel : 'test';
Â  Â  Â  Â  const questions = inputs.length;

Â  Â  Â  Â  const res = interpretResult(total, questions, testKey);

Â  Â  Â  Â  // show hasil-area
Â  Â  Â  Â  document.getElementById('hasil-area').style.display = 'block';
Â  Â  Â  Â  document.getElementById('hasil-title').textContent = res.title + ' â€” ' + testKey.charAt(0).toUpperCase() + testKey.slice(1);
Â  Â  Â  Â  document.getElementById('hasil-emoji').textContent = res.emoji;
Â  Â  Â  Â  document.getElementById('hasil-score').textContent = `Skor kesehatan (lebih tinggi = lebih baik): ${res.healthyPercent}%`;
Â  Â  Â  Â  document.getElementById('hasil-interpretasi').textContent = res.interp;

Â  Â  Â  Â  // store last result in DOM for save/download
Â  Â  Â  Â  document.getElementById('hasil-area').dataset.lastResult = JSON.stringify({
Â  Â  Â  Â  Â  testKey, total, questions, ...res, timestamp: new Date().toISOString()
Â  Â  Â  Â  });

Â  Â  Â  Â  // scroll into view
Â  Â  Â  Â  document.getElementById('hasil-area').scrollIntoView({behavior:'smooth'});
Â  Â  Â  });
Â  Â  });

Â  Â  /**********************
Â  Â  Â * Reset buttons per panel
Â  Â  Â **********************/
Â  Â  document.querySelectorAll('.btn-reset').forEach(btn=>{
Â  Â  Â  btn.addEventListener('click', ()=>{
Â  Â  Â  Â  const form = btn.closest('.test-panel').querySelector('.test-form');
Â  Â  Â  Â  // Reset input value to 1
Â  Â  Â  Â  form.querySelectorAll('input[type="number"]').forEach(i=>{
Â  Â  Â  Â  Â  Â  i.value = 1;
Â  Â  Â  Â  Â  Â  i.style.border = '1px solid #ddd'; // Reset border
Â  Â  Â  Â  });
Â  Â  Â  Â  document.getElementById('hasil-area').style.display = 'none';
Â  Â  Â  });
Â  Â  });

    // ======================================
    // START NEW / COMPLETED JS FUNCTIONALITY
    // ======================================

Â  Â  /**********************
Â  Â  Â * Theme Chooser Logic (LocalStorage)
Â  Â  Â **********************/
    const THEME_STORAGE_KEY = 'mentalHealthTheme';
    const themeSelect = document.getElementById('theme-select');
    const headerElement = document.getElementById('main-header');
    const h2Elements = document.querySelectorAll('h2');
    const navLinks = document.querySelectorAll('nav ul li a');
    const responseMessageDiv = document.getElementById('response-message');

    function applyTheme(theme) {
        const body = document.body;
        
        // Clear all existing data-theme attributes
        body.removeAttribute('data-theme');
        headerElement.removeAttribute('data-theme');
        h2Elements.forEach(h => h.removeAttribute('data-theme'));
        document.querySelectorAll('button, .btn').forEach(b => b.removeAttribute('data-theme'));
        navLinks.forEach(a => a.removeAttribute('data-theme'));
        responseMessageDiv.removeAttribute('data-theme');
        document.querySelectorAll('.story-list-item').forEach(si => si.removeAttribute('data-theme'));


        if (theme !== 'default') {
            body.setAttribute('data-theme', theme);
            headerElement.setAttribute('data-theme', theme);
            h2Elements.forEach(h => h.setAttribute('data-theme', theme));
            document.querySelectorAll('button, .btn').forEach(b => b.setAttribute('data-theme', theme));
            navLinks.forEach(a => a.setAttribute('data-theme', theme));
            responseMessageDiv.setAttribute('data-theme', theme);
            document.querySelectorAll('.story-list-item').forEach(si => si.setAttribute('data-theme', theme));
        }
        // Save selection to localStorage
        try {
            localStorage.setItem(THEME_STORAGE_KEY, theme);
        } catch (e) {
            console.error("Could not save theme:", e);
        }
        // Call renderStories to re-apply theme to list items
        renderStories(); 
    }

    themeSelect.addEventListener('change', (e) => {
        applyTheme(e.target.value);
    });

    /**********************
     * Ruang Cerita (Story Room) Logic (LocalStorage)
     **********************/
    const STORY_STORAGE_KEY = 'mentalHealthStories';

    function loadStories() {
        try {
            const storiesJson = localStorage.getItem(STORY_STORAGE_KEY);
            return storiesJson ? JSON.parse(storiesJson) : [];
        } catch (error) {
            console.error("Error loading stories:", error);
            return [];
        }
    }

    function saveStories(stories) {
        try {
            localStorage.setItem(STORY_STORAGE_KEY, JSON.stringify(stories));
        } catch (error) {
            console.error("Error saving stories:", error);
        }
    }

    function deleteStory(timestamp) {
        let stories = loadStories();
        stories = stories.filter(story => story.timestamp !== timestamp);
        saveStories(stories);
        renderStories();
        
        // Optional: show quick message
        const responseDiv = document.getElementById('response-message');
        const responseText = document.getElementById('response-text');
        responseText.textContent = 'Cerita telah dihapus.';
        responseDiv.style.display = 'block';
        setTimeout(() => responseDiv.style.display = 'none', 3000);
    }

    function renderStories() {
        const listContainer = document.getElementById('stories-list');
        const currentTheme = themeSelect.value;
        const stories = loadStories();
        listContainer.innerHTML = '';

        if (stories.length === 0) {
            listContainer.innerHTML = '<p class="card" style="padding: 15px; color: #999;">Belum ada cerita yang tersimpan.</p>';
            return;
        }

        stories.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp)); // Latest first

        stories.forEach(story => {
            const date = new Date(story.timestamp).toLocaleString('id-ID', {
                year: 'numeric', month: 'long', day: 'numeric',
                hour: '2-digit', minute: '2-digit'
            });

            const storyItem = document.createElement('div');
            storyItem.className = 'story-list-item';
            storyItem.setAttribute('data-theme', currentTheme === 'default' ? '' : currentTheme);
            storyItem.setAttribute('data-timestamp', story.timestamp);

            storyItem.innerHTML = `
                <h4 style="color:inherit;">[Topik: ${story.topic}] - ${date}</h4>
                <p style="white-space: pre-wrap; margin-bottom: 10px;">"${story.text.length > 200 ? story.text.substring(0, 200) + '...' : story.text}"</p>
                <button class="btn delete-story-btn" data-timestamp="${story.timestamp}" style="padding: 6px 12px; font-size: 0.9rem;">Hapus</button>
            `;
            listContainer.appendChild(storyItem);
        });

        // Attach delete event listeners
        listContainer.querySelectorAll('.delete-story-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                const timestamp = e.target.dataset.timestamp;
                if (confirm('Yakin ingin menghapus cerita ini?')) {
                    deleteStory(timestamp);
                }
            });
        });
    }

    document.getElementById('story-form').addEventListener('submit', function(e) {
        e.preventDefault();

        const topicSelect = document.getElementById('topic-select');
        const storyTextarea = document.getElementById('story-textarea');
        const responseDiv = document.getElementById('response-message');
        const responseText = document.getElementById('response-text');

        if (!topicSelect.value || !storyTextarea.value.trim()) {
            alert("Harap pilih topik dan tulis cerita Anda.");
            return;
        }

        const newStory = {
            topic: topicSelect.options[topicSelect.selectedIndex].text,
            text: storyTextarea.value.trim(),
            timestamp: new Date().toISOString()
        };

        let stories = loadStories();
        stories.push(newStory);
        saveStories(stories);
        renderStories();

        // Reset form
        topicSelect.value = '';
        storyTextarea.value = '';

        // Simple response
        const responses = [
            "Terima kasih sudah berbagi. Ingat, kamu tidak sendirian.",
            "Kami menghargai keberanianmu untuk bercerita. Semoga harimu membaik!",
            "Ceritamu aman di sini. Mengeluarkan beban adalah langkah pertama yang kuat.",
            "Dunia mendengarkan. Ambil napas dalam-dalam, kamu sudah melakukan hal yang hebat."
        ];
        responseText.textContent = responses[Math.floor(Math.random() * responses.length)];
        responseDiv.style.display = 'block';
        responseDiv.scrollIntoView({ behavior: 'smooth' });

        setTimeout(() => responseDiv.style.display = 'none', 5000);
    });

    /**********************
     * Save result locally (localStorage)
     **********************/
    const RESULT_STORAGE_KEY = 'mentalHealthResults';

    document.getElementById('saveLocal').addEventListener('click', ()=>{
        const area = document.getElementById('hasil-area');
        const last = area.dataset.lastResult;
        
        if (!last) { 
            alert('Belum ada hasil untuk disimpan. Harap selesaikan tes terlebih dahulu.'); 
            return;
        }

        try {
            const newResult = JSON.parse(last);
            let results = loadTestResults();
            results.push(newResult);
            // Only keep the last 20 results to prevent storage bloat
            if (results.length > 20) results.shift(); 
            localStorage.setItem(RESULT_STORAGE_KEY, JSON.stringify(results));

            // Feedback to user
            alert(`Hasil Tes ${newResult.testKey.charAt(0).toUpperCase() + newResult.testKey.slice(1)} tersimpan!\nTotal Hasil Tersimpan: ${results.length}`);
        } catch (e) {
            console.error("Error saving result:", e);
            alert("Gagal menyimpan hasil.");
        }
    });

    function loadTestResults() {
        try {
            const resultsJson = localStorage.getItem(RESULT_STORAGE_KEY);
            return resultsJson ? JSON.parse(resultsJson) : [];
        } catch (error) {
            console.error("Error loading test results:", error);
            return [];
        }
    }


    /**********************
     * Download result
     **********************/
    document.getElementById('downloadResult').addEventListener('click', () => {
        const area = document.getElementById('hasil-area');
        const last = area.dataset.lastResult;

        if (!last) {
            alert('Belum ada hasil untuk diunduh. Harap selesaikan tes terlebih dahulu.');
            return;
        }

        try {
            const result = JSON.parse(last);
            const date = new Date(result.timestamp).toLocaleString('id-ID', {
                year: 'numeric', month: 'long', day: 'numeric',
                hour: '2-digit', minute: '2-digit'
            });
            const testName = result.testKey.charAt(0).toUpperCase() + result.testKey.slice(1);

            const content = `
Hasil Tes Kesehatan Mental
--------------------------
Jenis Tes: ${testName}
Tanggal: ${date}
Skor Total (raw): ${result.total} dari ${result.questions * 5}
Skor Kesehatan (lebih tinggi = lebih baik): ${result.healthyPercent}%
Tingkat: ${result.title} ${result.emoji}
Interpretasi: ${result.interp}

Catatan: Ini adalah tes screening sederhana non-medis. Jika Anda merasa khawatir, harap cari bantuan profesional.
            `.trim();

            // Create Blob and download link
            const blob = new Blob([content], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `Hasil_Tes_Mental_${testName}_${new Date().toLocaleDateString('en-CA').replace(/-/g, '')}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url); // Clean up
        } catch (e) {
            console.error("Error creating download file:", e);
            alert("Gagal membuat file unduhan.");
        }
    });

    /**********************
     * Initialize on DOM Content Load
     **********************/
    document.addEventListener('DOMContentLoaded', () => {
        // 1. Initialize theme from localStorage or default
        const savedTheme = localStorage.getItem(THEME_STORAGE_KEY) || 'default';
        themeSelect.value = savedTheme; // Set dropdown value
        applyTheme(savedTheme); // Apply theme styles

        // 2. Load and render saved stories (Ruang Cerita)
        renderStories();
    });

Â  Â  /**********************
Â  Â  Â * Extra: small keyboard accessibility for tabs
Â  Â  Â **********************/
Â  Â  document.querySelectorAll('.tab').forEach((t, i, list) => {
Â  Â  Â  t.setAttribute('tabindex','0');
Â  Â  Â  t.addEventListener('keydown', (e)=>{\r\n        if (e.key === 'ArrowRight') { list[(i+1)%list.length].focus(); e.preventDefault(); }\r\n        if (e.key === 'ArrowLeft') { list[(i-1+list.length)%list.length].focus(); e.preventDefault(); }\r\n        if (e.key === 'Enter' || e.key === ' ') t.click();
Â  Â  Â  });
Â  Â  });

Â  </script>
</body>
</html>